<p><%= @movie.title %></p>
<p><%= @movie.studio %></p>
<p><%= @movie.year %></p>
<p><%= @movie.rating %></p>
<p><%= @movie.genre %></p>
<p><%= @movie.cast %></p>
<p><%= @movie.screen_writer %></p>
<p><%= @movie.director %></p>
<p><%= link_to "Edit", edit_movie_path(@movie) %></p>
<p><%= link_to "Delete", movie_path(@movie), method: :delete %></p>
<p><%= link_to "Back to Index", movies_path %></p>

<h3>Write Review</h3>

<%= render "reviews/review_form" %>

<% unless @reviews.nil? %>
  <% @reviews.each_with_index do |review, index| %>
    <p>
      <% upvotes = 0 %>
      <% downvotes = 0 %>
      <%= review.title %>
      <%= review.rating %>
      <%= review.body %>
      <% if @user.id == review.user_id %>
        <%= link_to "Edit Review", edit_movie_review_path(@movie, review) %>
        <%= link_to "Delete Review", movie_review_path(@movie, review), method: :delete %>
      <% end %>
      <% review.votes.each do |vote|  %>
        <%  upvotes += vote.upvote %>
        <%  downvotes += vote.downvote %>
      <% end %>
      <% upvote_id = "Upvote_#{index + 1}" %>
      <% downvote_id = "Downvote_#{index + 1}" %>
      <%= form_for review, remote: true do |r| %>
        <%= link_to "Upvote", upvote_path, remote: true, id: "upvote" %><div id="upvote-count"></div>
      <% end %>
      <%= button_to "Downvote", downvote_review_votes_path(review), method: :post, id: downvote_id %> <%=  downvotes %>
    </p>
  <% end %>
<% end %>
